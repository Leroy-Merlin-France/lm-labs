<?xml version="1.0"?>

<component name="com.leroymerlin.corp.fr.nuxeo.labs.pageproviders.contrib">

  <extension target="org.nuxeo.ecm.platform.query.api.PageProviderService"
    point="providers">


    <genericPageProvider name="latest_uploads"
      class="com.leroymerlin.corp.fr.nuxeo.labs.site.providers.LatestUploadsPageProvider">
    </genericPageProvider>

<!-- 
    <coreQueryPageProvider name="latest_uploads_nxql">
      <pattern quoteParameters="true" escapeParameters="true">
        SELECT * FROM Document WHERE ecm:mixinType <> 'HiddenInNavigation'
        AND ecm:isCheckedInVersion = 0 AND ecm:currentLifeCycleState != 'deleted'
        AND ecm:path STARTSWITH ?
      </pattern>
      <pageSize>5</pageSize>
      <sort column="dc:modified" ascending="false" />
    </coreQueryPageProvider>
 -->
 
 	<coreQueryPageProvider name="list_line_nxql">
      <pattern quoteParameters="true" escapeParameters="true">
        SELECT * FROM PageListLine WHERE ecm:isCheckedInVersion = 0 AND ecm:currentLifeCycleState != 'deleted'
        AND ecm:parentId = ? AND ecm:mixinType != 'LabsHidden'
      </pattern>
      <sort column="dc:created" ascending="true" />
    </coreQueryPageProvider>
 
 	<coreQueryPageProvider name="list_line_write_nxql">
      <pattern quoteParameters="true" escapeParameters="true">
        SELECT * FROM PageListLine WHERE ecm:isCheckedInVersion = 0 AND ecm:currentLifeCycleState != 'deleted'
        AND ecm:parentId = ?
      </pattern>
      <sort column="dc:created" ascending="true" />
    </coreQueryPageProvider>
 
 	<coreQueryPageProvider name="list_news_write_nxql">
      <pattern quoteParameters="true" escapeParameters="true">
        SELECT * FROM LabsNews WHERE ecm:isCheckedInVersion = 0 AND ecm:currentLifeCycleState != 'deleted'
        AND ecm:parentId = ?
      </pattern>
      <sort column="ln:startPublication" ascending="false" />
    </coreQueryPageProvider>
 
 	<coreQueryPageProvider name="list_news_nxql">
      <pattern quoteParameters="true" escapeParameters="true">
        SELECT * FROM LabsNews WHERE ecm:isCheckedInVersion = 0 AND ecm:currentLifeCycleState != 'deleted'
        AND ecm:parentId = ? AND ln:startPublication &lt;= DATE ? AND (ln:endPublication IS NULL OR ln:endPublication > DATE ?)
      </pattern>
      <sort column="ln:startPublication" ascending="false" />
    </coreQueryPageProvider>
 

  </extension>

</component>
